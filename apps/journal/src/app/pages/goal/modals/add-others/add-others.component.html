<ion-header>
  <ion-toolbar mode="md">
    <ion-searchbar placeholder="Search" (ionChange)="search($event)"></ion-searchbar>
  </ion-toolbar>
  <ion-buttons slot="end">
    <ion-button (click)="dismiss()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-header>
<ion-content class="ion-padding">
  <ng-container *ngIf="results$ | async as profiles; else loading">
    <ng-container *ngIf="profiles.length else empty">
      <ion-list mode="md">
        <ng-container *ngFor="let profile of results$ | async; let last = last">
          <ion-item [lines]="last ? 'none' : 'inset'">
            <ion-avatar slot="start">
              <img asset="profile.png" [ref]="profile.photoURL">
            </ion-avatar>
            <ion-label>
              <article>
                <span>{{ profile.username }}</span>
                <small>{{ profile | subtitle }}</small>
              </article>
            </ion-label>
            <ion-button (click)="invite(profile)" slot="end" fill="outline" color="primary" [disabled]="profile.isStakeholder || profile.openInvite">
              {{ profile | inviteText }}
            </ion-button>
          </ion-item>
        </ng-container>
      </ion-list>
    </ng-container>
  </ng-container>
</ion-content>
<ion-footer>
  <small>Invite someone without Strive Journal account?</small>
  <ion-button (click)="share($event)" color="primary" size="small">
    <ion-icon slot="start" name="share-social-outline"></ion-icon>
    <span>Share link</span>
  </ion-button>
</ion-footer>

<ng-template #loading>
  <section>
    <ion-spinner name="lines" color="primary"></ion-spinner>
  </section>
</ng-template>

<ng-template #empty>
  <section>
    <i *ngIf="query === ''">Search to find Strive users</i>
    <i *ngIf="query !== ''">No results found</i>
  </section>
</ng-template>