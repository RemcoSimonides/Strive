<ng-container *ngIf="pageIsLoading">
  <strive-page-loading></strive-page-loading>
</ng-container>

<ng-container *ngIf="!canAccess && !pageIsLoading">
  <strive-page-not-found></strive-page-not-found>
</ng-container>

<ng-container *ngIf="canAccess && !pageIsLoading">
  <ion-toolbar>
    <ion-segment (ionChange)="segmentChanged($event)" class="ion-align-self-center">
      <ion-segment-button value="Goal" checked>
        Goal
      </ion-segment-button>
      <ion-segment-button value="Roadmap">
        Roadmap
      </ion-segment-button>
      <ion-segment-button value="Posts">
        Posts
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ng-container>

<ion-content class="ion-no-padding" [ngSwitch]="segmentChoice" *ngIf="canAccess && !pageIsLoading">

  <section *ngSwitchCase="'Goal'" class="vertical-align-content">
    <journal-goal></journal-goal>
  </section>

  <!-- Roadmap -->
  <section *ngSwitchCase="'Roadmap'" class="vertical-align-content">
    <app-default-roadmap [goalId]="goalId"></app-default-roadmap>
  </section>

  <!-- Posts -->
  <section *ngSwitchCase="'Posts'" class="vertical-align-content">

    <ion-refresher slot="fixed" (ionRefresh)="refreshPosts($event)">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>
 
    <ng-container *ngFor="let notification of paginationService.data | async">
      <app-notification [goalId]="goalId" [notification]="notification" [isAdmin]="isAdmin" [reference]="'Goals/' + goalId + '/Notifications/' + notification.id"></app-notification>
    </ng-container>

    <ion-fab *ngIf="isAdmin" vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button (click)="createCustomPost()"><ion-icon name="add"></ion-icon></ion-fab-button>
    </ion-fab>

    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
      <ion-infinite-scroll-content
        loadingSpinner="bubbles"
        loadingText="Loading more data...">
      </ion-infinite-scroll-content>
    </ion-infinite-scroll>

  </section>

</ion-content>
