<strive-header title="Self Reflect Settings" defaultBack="/exercise/self-reflect" color="primary" />

<ion-content class="ion-padding">
  <main>
    <h1 *ngIf="(isMobile$ | async) === false">Settings</h1>

    <ng-container *ngIf="loading() else notLoading">
	    <strive-page-loading></strive-page-loading>
    </ng-container>

  </main>
</ion-content>

<ng-template #notLoading>
  <form [formGroup]="form">
    <ion-list mode="md" lines="full">
      <small class="reminder">What day and time would you prefer to receive the Self Reflection reminder?</small>
      <ion-item>
        <ion-select interface="popover" formControlName="preferredDay" label="Day">
          <ion-select-option value="monday">Monday</ion-select-option>
          <ion-select-option value="tuesday">Tuesday</ion-select-option>
          <ion-select-option value="wednesday">Wednesday</ion-select-option>
          <ion-select-option value="thursday">Thursday</ion-select-option>
          <ion-select-option value="friday">Friday</ion-select-option>
          <ion-select-option value="saturday">Saturday</ion-select-option>
          <ion-select-option value="sunday">Sunday</ion-select-option>
          <ion-select-option value="never">Never</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item lines="none" button (click)="openTimePicker()">
        <ion-label>Time</ion-label>
        <ion-text>{{ form.get('preferredDay').value === 'never' ? '-' : form.get('preferredTime').value }}</ion-text>
      </ion-item>
    </ion-list>
  </form>

  <form>
    <ion-list mode="md" lines="full">
      <ng-container *ngFor="let questionControl of form.questions.controls; let last = last">
        <ion-item [lines]="last ? 'none' : 'full'" button (click)="openAlert(questionControl)" class="question">
          <section>
            <span>{{ questionControl.question.value | replaceInterval: questionControl.interval.value }}</span>
            <small>
              <span>Frequency:</span>
              <span>{{ questionControl.interval.value | titlecase }}</span>
              <span>Category:</span>
              <span>{{ categories[questionControl.category.value] }}</span>
              <span>Tense:</span>
              <span>{{ questionControl.tense.value | titlecase }}</span>
            </small>
          </section>
        </ion-item>
      </ng-container>
    </ion-list>
  </form>

    <h2>Custom Questions</h2>
    <ion-list mode="md">
      <ion-item *ngFor="let question of customQuestions$ | async" button (click)="openQuestion(question)">
        <ion-label>
          <section>
            <span>{{ question.question }}</span>
            <small>{{ categories[question.category] }} - {{ question.interval | titlecase }}</small>
          </section>
        </ion-label>
      </ion-item>
      <ion-item button (click)="openQuestion()" lines="none" class="add-question">
        <ion-label>Add Question</ion-label>
        <ion-icon slot="end" name="add-outline"/>
      </ion-item>
    </ion-list>
</ng-template>
